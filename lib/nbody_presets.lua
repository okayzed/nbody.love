-- presets taken from http://www.princeton.edu/~rvdb/WebGL/nBody.html

local dim = 3
local df=200
local x = {}
local y = {}
local z = {}
local vx = {}
local vy = {}
local vz = {}

function reset()
  df=200
  x = {}
  y = {}
  z = {}
  vx = {}
  vy = {}
  vz = {}
end

function read_preset()
  ret = {}
  GRAVITY=1
  PRINT_EVERY=0.01
  for i = 1,dim do
    GRAVITY = GRAVITY * df
  end

  for i = 0, #x do
    b = Body:new()
    b.m = 1
    b.r = 10000
    b:adjust()
    b.x[1] = x[i] * df
    b.x[2] = y[i] * df
    b.x[3] = (z[i] or 0) * df
    b.v[1] = vx[i] * df
    b.v[2] = vy[i] * df
    b.v[3] = (vz[i] or 0) * df

    table.insert(ret, b)
  end

  return ret
end

function ducati3()
  H=1e-3
  x[0]=   0.000000000000000; y[0]=  -0.070946548000287;
  x[1]=  -0.000000000000000; y[1]=   1.075903540029147;
  x[2]=  -0.000000000000000; y[2]=  -1.004956992028862;
  vx[0]=  -1.231870762148251; vy[0]=   0.000000000000000;
  vx[1]=   0.195089035291636; vy[1]=  -0.000000000000000;
  vx[2]=   1.036781726856616; vy[2]=   0.000000000000000;
end

function hill3()

  x[0]=   -0.97212972561663; y[0]=    0.00000000000000; z[0]=   -0.00000000000000;
  x[1]=    0.78241714882997; y[1]=    0.00000000000000; z[1]=   -0.00000000000000;
  x[2]=    0.18971257696452; y[2]=   -0.00000000000000; z[2]=    0.00000000000000;
  vx[0]=    0.01115929702513; vy[0]=   -0.97747814152844; vz[0]=    0.00000000000000;
  vx[1]=   -0.03321095312270; vy[1]=   -0.44753450954021; vz[1]=   -0.00000000000000;
  vx[2]=    0.02205165609570; vy[2]=    1.42501265124650; vz[2]=    0.00000000000000;
end

function lagrange2()
  dim=3
  x[0]=    0.62996820478109; y[0]=   -0.00000000001876;
  x[1]=   -0.62996820478109; y[1]=    0.00000000001876;
  vx[0]=   -0.00659677045079; vy[0]=    0.62992214996201;
  vx[1]=    0.00659677045079; vy[1]=   -0.62992214996201;
end

function triangle3()
  H=1e-5
  dim=3
  x[0]=   -2.05332843842641; y[0]=    0.06515421597004; z[0]=    0.00000000000000;
  x[1]=   -2.23545974561022; y[1]=   -1.93839993409122; z[1]=    0.00000000000000;
  x[2]=    3.81861553376126; y[2]=   -2.00685005915837; z[2]=    0.00000000000000;
  x[3]=    0.47017265027538; y[3]=    3.88009577727955; z[3]=    0.00000000000000;
  vx[0]=   -0.33452037030058; vy[0]=   -0.77453229089669; vz[0]=    0.00000000000000;
  vx[1]=    0.43791625027997; vy[1]=    0.35139088613852; vz[1]=    0.00000000000000;
  vx[2]=   -0.00544283410380; vy[2]=    0.15800391467454; vz[2]=    0.00000000000000;
  vx[3]=   -0.09795304587558; vy[3]=    0.26513749008363; vz[3]=    0.00000000000000;

end

function triple_ellipse()
  H=1e-4
  x[0]=   -2.16956349532265; y[0]=   -0.00000025649906; z[0]=    0.00000000000000;
  x[1]=   -1.75872222918418; y[1]=    0.00000013533832; z[1]=    0.00000000000000;
  x[2]=    3.92828572450682; y[2]=    0.00000012116074; z[2]=    0.00000000000000;
  vx[0]=    0.00000079275837; vy[0]=   -1.58094804454189; vz[0]=    0.00000000000000;
  vx[1]=   -0.00000078170110; vy[1]=    1.43767928475263; vz[1]=    0.00000000000000;
  vx[2]=   -0.00000001105727; vy[2]=    0.14326875978926; vz[2]=    0.00000000000000;
end

function star_of_david()
  H=1e-5
  x[0]=  -1.235888490363221; y[0]=  -0.713583166852466; z[0] = 0.0;
  x[1]=  -0.460304352286014; y[1]=  -0.271346655958059; z[1] = 0.0;
  x[2]=   0.460304352286014; y[2]=   0.271346655958059; z[2] = 0.0;
  x[3]=   1.235888490363221; y[3]=   0.713583166852466; z[3] = 0.0;
  vx[0]=  -0.010702760715048; vy[0]=   0.028615747036639; vz[0] = 0.0;
  vx[1]=   0.777912175865836; vy[1]=  -1.347833138138306; vz[1] = 0.0;
  vx[2]=  -0.777912175865836; vy[2]=   1.347833138138306; vz[2] = 0.0;
  vx[3]=   0.010702760715048; vy[3]=  -0.028615747036639; vz[3] = 0.0;
end

function five_point_star()
	H=1e-5
	x[0] = 1.0598738926379;  y[0] = 1.7699901770118;
	x[1] = 0;                y[1] =-0.80951135793043;
	x[2] = -1.0598738926379; y[2] = 1.7699901770118;
	x[3] = 0;                y[3] =-2.7304689960932;
	vx[0] = -0.55391384867197;  vy[0] = -0.39895079845794;
	vx[1] = 1.0936551555351;    vy[1] = 0;
	vx[2] = -0.55391558212647;  vy[2] = 0.39895379682134;
	vx[3] = 0.01417427526245;   vy[3] = 0;
end

function sixbody_3d()
	H=1e-5
	x[0]=    1.18414930766743; y[0]=    0.17042861225661; z[0]=    0.02539288783560;
	x[1]=   -0.02539347370509; y[1]=    1.18414930052823; z[1]=    0.17042857456575;
	x[2]=   -0.17042793538282; y[2]=   -0.02539351987933; z[2]=    1.18414939153253;
	vx[0]=   -0.02783688464320; vy[0]=    0.23069209042560; vz[0]=    1.14440660017489;
	vx[1]=   -1.14440646258809; vy[1]=   -0.02783752778821; vz[1]=    0.23069269535160;
	vx[2]=   -0.23069205693964; vy[2]=   -1.14440659544184; vz[2]=   -0.02783735671544;
	for j=0,2 do
		 x[3+j] =  -x[j];  y[3+j] =  -y[j];  z[3+j] =  -z[j];
		vx[3+j] = -vx[j]; vy[3+j] = -vy[j]; vz[3+j] = -vz[j];
	end

end

local presets = {
  ducati3,
  hill3,
  lagrange2,
	triple_ellipse,
	sixbody_3d,
	triangle3,
	five_point_star,
	star_of_david,
}
local focused = 1

return {
  main=function()
    reset()
    presets[focused]()
    return read_preset()
  end,
  back=function()
    if focused == 1 then
      focused = #presets
    else
      focused = focused - 1
    end
  end,
  next=function()
    focused = (focused % #presets) + 1
  end,
  presets=presets
}
